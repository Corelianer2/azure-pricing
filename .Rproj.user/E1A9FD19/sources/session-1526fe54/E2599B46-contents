library(httr)
library(jsonlite)
library(duckdb)
library(dplyr)

# Poll data from API
response <- GET("https://prices.azure.com/api/retail/prices")
data <- content(response, as = "parsed")
df <- bind_rows(as.data.frame(data))

View(df)

df2 <- bind_rows(data)

str(data)

print(response)
print(data)
View(df)

# Save to DuckDB
con <- dbConnect(duckdb::duckdb(), dbdir = "arp.duckdb")
dbWriteTable(con, "api_data", df, overwrite = TRUE)
dbDisconnect(con)